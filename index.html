<!DOCTYPE html>
<html>
<head>
    <title>Love Heart</title>
    <style>
        body {
            background-color: #F4C2C2;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }
        canvas {
            display: block;
        }
    </style>
</head>
<body>
    <canvas id="heartCanvas" width="800" height="600"></canvas>

    <script>
        const canvas = document.getElementById('heartCanvas');
        const ctx = canvas.getContext('2d');
        
        // Сохраняем все точки сердца
        let heartPoints = [];
        let heartComplete = false;
        let animationStartTime;
        let i = 0;
        
        // Текстовые сообщения
        const messages = [
            { text: "Dasha", y: 90, fontSize: 48, color: "red", letters: [] },
            { text: "I love you!", y: 30, fontSize: 36, color: "red", letters: [] },
            { text: ":3", y: -30, fontSize: 40, color: "red", letters: [] }
        ];
        
        let lastLetterTime = 0;
        const letterDelay = 100; // Задержка между буквами в мс

        // Функции для построения сердца (аналогичные Python-коду)
        function heart(k) {
            return 15 * Math.sin(k) ** 3;
        }

        function heart1(k) {
            const y = 12 * Math.cos(k) - 5 * Math.cos(2 * k) - 2 * Math.cos(3 * k) - Math.cos(4 * k);
            return y * 1.25;
        }

        // Очистка canvas
        function clearCanvas() {
            ctx.fillStyle = '#F4C2C2';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }

        // Рисование всех точек сердца
        function drawHeartPoints() {
            if (heartPoints.length < 2) return;
            
            ctx.strokeStyle = 'deepskyblue';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(heartPoints[0].x, heartPoints[0].y);
            
            for (let i = 1; i < heartPoints.length; i++) {
                ctx.lineTo(heartPoints[i].x, heartPoints[i].y);
            }
            
            ctx.stroke();
        }

        // Добавление новых точек сердца
        function addHeartPoint() {
            const x = heart(i) * 25;
            const y = heart1(i) * 20 + 20;
            
            heartPoints.push({
                x: canvas.width / 2 + x,
                y: canvas.height / 2 - y
            });
            
            i += 0.05;
        }

        // Инициализация текста
        function initText() {
            messages.forEach(msg => {
                msg.letters = msg.text.split('');
                msg.drawnLetters = [];
                ctx.font = `italic bold ${msg.fontSize}px Courier`;
                msg.textWidth = ctx.measureText(msg.text).width;
            });
        }

        // Рисование текста по буквам
        function drawText() {
            const now = Date.now();
            if (now - lastLetterTime < letterDelay) return;
            
            lastLetterTime = now;
            
            let letterAdded = false;
            
            messages.forEach(msg => {
                if (msg.letters.length > 0) {
                    const letter = msg.letters.shift();
                    msg.drawnLetters.push(letter);
                    letterAdded = true;
                }
            });
            
            if (!letterAdded) return;
            
            // Перерисовываем весь текст
            messages.forEach(msg => {
                if (msg.drawnLetters.length === 0) return;
                
                ctx.font = `italic bold ${msg.fontSize}px Courier`;
                ctx.fillStyle = msg.color;
                const fullText = msg.drawnLetters.join('');
                const x = canvas.width / 2 - msg.textWidth / 2;
                const y = canvas.height / 2 - msg.y;
                
                ctx.fillText(fullText, x, y);
            });
        }

        // Основной цикл анимации
        function animate() {
            clearCanvas();
            
            // Рисуем сохраненные точки сердца
            drawHeartPoints();
            
            // Если сердце еще не полностью нарисовано, добавляем новые точки
            if (!heartComplete) {
                addHeartPoint();
                
                if (!animationStartTime) animationStartTime = Date.now();
                if (Date.now() - animationStartTime > 11000) {
                    heartComplete = true;
                    initText();
                }
            }
            
            // Рисуем текст, если сердце готово
            if (heartComplete) {
                drawText();
            }
            
            requestAnimationFrame(animate);
        }

        // Запуск анимации
        animate();
    </script>
</body>
</html>
