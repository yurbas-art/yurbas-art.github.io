<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Animated Heart with Text</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background-color: #F4C2C2; /* Бежево-красный фон */
    }
    canvas {
      display: block;
    }
  </style>
</head>
<body>
<canvas id="canvas"></canvas>
<script>
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');
  
  function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }
  resize();
  window.addEventListener('resize', resize);

  const cx = canvas.width / 2;
  const cy = canvas.height / 2 + 20; // смещение по Y для выравнивания текста
  const scaleX = 25;
  const scaleY = 20;

  function heartX(t) {
    return 15 * Math.pow(Math.sin(t), 3);
  }

  function heartY(t) {
    const y = 12 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t);
    return y * 1.25;
  }

  let t = 0;
  let points = [];
  let startTime = performance.now();
  let drawComplete = false;
  
  function drawHeart(timestamp) {
    if (!drawComplete && (timestamp - startTime) < 11000) {
      const x = cx + heartX(t) * scaleX;
      const y = cy - heartY(t) * scaleY;
      points.push({ x, y });
      
      if (points.length > 1) {
        ctx.beginPath();
        ctx.strokeStyle = 'deepskyblue';
        ctx.lineWidth = 2;
        ctx.moveTo(points[points.length - 2].x, points[points.length - 2].y);
        ctx.lineTo(points[points.length - 1].x, points[points.length - 1].y);
        ctx.stroke();
      }
      
      t += 0.05;
      requestAnimationFrame(drawHeart);
    } else if (!drawComplete) {
      drawComplete = true;
      showText();
    }
  }

  function showText() {
    const lines = [
      { text: "Dasha", y: -90, fontSize: 48 },
      { text: "I love you!", y: -30, fontSize: 36 },
      { text: ":3", y: 30, fontSize: 40 },
    ];

    let index = 0;

    function typeLine() {
      if (index >= lines.length) return;

      const { text, y, fontSize } = lines[index];
      let i = 0;

      function typeChar() {
        const line = text.substring(0, i + 1);
        ctx.clearRect(cx - 300, cy + y - fontSize, 600, fontSize + 10);
        ctx.font = `italic bold ${fontSize}px Courier`;
        ctx.fillStyle = 'red';
        ctx.textAlign = 'center';
        ctx.fillText(line, cx, cy + y);
        
        i++;
        if (i < text.length) {
          setTimeout(typeChar, Math.random() * 150 + 50);
        } else {
          index++;
          setTimeout(typeLine, 300);
        }
      }

      typeChar();
    }

    typeLine();
  }

  drawHeart();
</script>
</body>
</html>
