<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Heart Animation</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background-color: #F4C2C2;
      font-family: 'Courier New', monospace;
    }
    canvas {
      display: block;
    }
    #text-container {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      color: red;
      font-style: italic;
      font-weight: bold;
    }
    .line {
      font-size: 36px;
    }
  </style>
</head>
<body>
  <canvas id="canvas"></canvas>
  <div id="text-container"></div>

  <script>
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const heartX = t => 15 * Math.sin(t) ** 3;
    const heartY = t => (12 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t)) * 1.25;

    let t = 0;
    const dt = 0.02;
    const scale = Math.min(canvas.width, canvas.height) * 0.03;
    const centerX = canvas.width / 2;
    const centerY = canvas.height / 2;
    let points = [];

    const startTime = Date.now();
    const duration = 15000;
    let textStarted = false;

    function drawHeart() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.beginPath();
      ctx.strokeStyle = "deepskyblue";
      ctx.lineWidth = 3;
      if (points.length > 0) ctx.moveTo(points[0].x, points[0].y);
      for (let p of points) {
        ctx.lineTo(p.x, p.y);
      }
      ctx.stroke();
    }

    function animate() {
      const elapsed = Date.now() - startTime;

      if (elapsed < duration) {
        const x = centerX + heartX(t) * scale;
        const y = centerY - heartY(t) * scale; // перевернутое сердце
        points.push({ x, y });
        t += dt;
        drawHeart();
        requestAnimationFrame(animate);
      } else {
        drawHeart();
        if (!textStarted) {
          textStarted = true;
          writeTextSlowly("Dasha", 0);
        }
      }
    }

    const lines = [
      { text: "Dasha", fontSize: 48 },
      { text: "I love you!", fontSize: 36 },
      { text: ":3", fontSize: 40 }
    ];

    let lineIndex = 0;
    let charIndex = 0;

    function writeTextSlowly(text, yOffset) {
      const container = document.getElementById("text-container");
      const div = document.createElement("div");
      div.className = "line";
      div.style.fontSize = `${lines[lineIndex].fontSize}px`;
      container.appendChild(div);

      function typeLetter() {
        if (charIndex < text.length) {
          div.textContent += text[charIndex];
          charIndex++;
          setTimeout(typeLetter, Math.random() * 150 + 50);
        } else {
          lineIndex++;
          charIndex = 0;
          if (lineIndex < lines.length) {
            setTimeout(() => writeTextSlowly(lines[lineIndex].text, yOffset + 50), 400);
          }
        }
      }
      typeLetter();
    }

    animate();
  </script>
</body>
</html>
