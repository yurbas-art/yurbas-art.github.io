<!DOCTYPE html> 
<html>
<head>
    <title>Love Heart</title>
    <style>
        body {
            background-color: #F4C2C2;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
            font-family: 'Courier New', monospace;
        }
        canvas {
            display: block;
            position: absolute;
        }
        #text-container {
            position: relative;
            z-index: 10;
            text-align: center;
            color: red;
        }
    </style>
</head>
<body>
    <canvas id="heartCanvas"></canvas>
    <div id="text-container"></div>

    <script>
        const canvas = document.getElementById('heartCanvas');
        const ctx = canvas.getContext('2d');
        const textContainer = document.getElementById('text-container');

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        let animationStartTime;
        let t = 0;
        let heartComplete = false;
        let heartPoints = [];

        const messages = [
            { text: "Dasha", fontSize: 48, yOffset: -0.25 },
            { text: "I love you!", fontSize: 36, yOffset: 0 },
            { text: ":3", fontSize: 40, yOffset: 0.2 }
        ];

        let currentMessage = 0;
        let currentLetter = 0;
        let lastLetterTime = 0;
        const letterDelay = 150;
        let messageStarted = false;

        function heartX(t) {
            return 15 * Math.pow(Math.sin(t), 3);
        }

        function heartY(t) {
            return 12 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t);
        }

        function drawHeart() {
            ctx.strokeStyle = 'deepskyblue';
            ctx.lineWidth = 3;
            ctx.beginPath();
            heartPoints.forEach((pt, idx) => {
                if (idx === 0) ctx.moveTo(pt.x, pt.y);
                else ctx.lineTo(pt.x, pt.y);
            });
            ctx.stroke();
        }

        function animateText() {
            if (currentMessage >= messages.length) return;

            const now = Date.now();
            if (now - lastLetterTime < letterDelay) return;
            lastLetterTime = now;

            const msg = messages[currentMessage];
            if (!msg.element) {
                msg.element = document.createElement('div');
                msg.element.style.fontSize = `${msg.fontSize}px`;
                msg.element.style.fontStyle = 'italic';
                msg.element.style.fontWeight = 'bold';
                msg.element.style.position = 'absolute';
                msg.element.style.left = '50%';
                msg.element.style.transform = 'translateX(-50%)';
                msg.element.style.top = `${50 + msg.yOffset * 100}%`;
                msg.element.textContent = "";
                textContainer.appendChild(msg.element);
            }

            msg.element.textContent += msg.text[currentLetter];
            currentLetter++;

            if (currentLetter >= msg.text.length) {
                currentMessage++;
                currentLetter = 0;
                lastLetterTime += 500; // задержка перед следующим сообщением
            }
        }

        function animate(timestamp) {
            if (!animationStartTime) animationStartTime = timestamp;
            const elapsed = timestamp - animationStartTime;

            ctx.fillStyle = '#F4C2C2';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2 + 40;
            const scale = Math.min(canvas.width, canvas.height) * 0.03;

            if (elapsed < 11000) {
                const x = centerX + heartX(t) * scale;
                const y = centerY - heartY(t) * scale * 1.25;
                heartPoints.push({ x, y });
                t += 0.05;
            } else if (!heartComplete) {
                heartComplete = true;
            }

            drawHeart();

            if (heartComplete) {
                animateText();
            }

            requestAnimationFrame(animate);
        }

        requestAnimationFrame(animate);
    </script>
</body>
</html>
