<!DOCTYPE html>
<html>
<head>
    <title>Love Heart</title>
    <style>
        body {
            background-color: #F4C2C2;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
            font-family: 'Courier New', monospace;
        }
        canvas {
            display: block;
            position: absolute;
        }
        #text-container {
            position: relative;
            z-index: 10;
            text-align: center;
            color: red;
        }
    </style>
</head>
<body>
    <canvas id="heartCanvas"></canvas>
    <div id="text-container"></div>

    <script>
        const canvas = document.getElementById('heartCanvas');
        const ctx = canvas.getContext('2d');
        const textContainer = document.getElementById('text-container');
        
        // Устанавливаем размер canvas равным размеру окна
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // Параметры анимации
        let animationStartTime;
        let i = 0;
        let heartComplete = false;
        let textAnimationComplete = false;
        const heartPoints = [];
        
        // Текст для отображения
        const messages = [
            { text: "Dasha", fontSize: 48, yOffset: 0.3 },
            { text: "I love you!", fontSize: 36, yOffset: 0.1 },
            { text: ":3", fontSize: 40, yOffset: -0.1 }
        ];
        let currentMessage = 0;
        let currentLetter = 0;
        let lastLetterTime = 0;
        const letterDelay = 150; // Задержка между буквами

        // Тригонометрические функции для сердца
        function heartX(t) {
            return 15 * Math.pow(Math.sin(t), 3);
        }

        function heartY(t) {
            return -(12 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t)) * 1.25;
        }

        // Рисование сердца
        function drawHeart() {
            ctx.strokeStyle = 'deepskyblue';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            // Рисуем все сохраненные точки
            for (let j = 0; j < heartPoints.length; j++) {
                const point = heartPoints[j];
                if (j === 0) {
                    ctx.moveTo(point.x, point.y);
                } else {
                    ctx.lineTo(point.x, point.y);
                }
            }
            
            ctx.stroke();
        }

        // Анимация текста
        function animateText() {
            const now = Date.now();
            if (now - lastLetterTime < letterDelay || textAnimationComplete) return;
            lastLetterTime = now;
            
            const msg = messages[currentMessage];
            if (!msg.element) {
                msg.element = document.createElement('div');
                msg.element.style.fontSize = `${msg.fontSize}px`;
                msg.element.style.fontStyle = 'italic';
                msg.element.style.fontWeight = 'bold';
                msg.element.style.position = 'absolute';
                msg.element.style.left = '50%';
                msg.element.style.transform = 'translateX(-50%)';
                msg.element.style.top = `${50 + msg.yOffset * 100}%`;
                textContainer.appendChild(msg.element);
            }
            
            msg.element.textContent = msg.text.substring(0, currentLetter + 1);
            currentLetter++;
            
            if (currentLetter >= msg.text.length) {
                currentLetter = 0;
                currentMessage++;
                
                if (currentMessage >= messages.length) {
                    textAnimationComplete = true;
                }
            }
        }

        // Основной цикл анимации
        function animate(timestamp) {
            if (!animationStartTime) animationStartTime = timestamp;
            const elapsed = timestamp - animationStartTime;
            
            ctx.fillStyle = '#F4C2C2';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Анимация сердца (11 секунд)
            if (elapsed < 11000) {
                const t = i * 0.03;
                const scale = Math.min(canvas.width, canvas.height) * 0.2;
                
                heartPoints.push({
                    x: canvas.width/2 + heartX(t) * scale/2,
                    y: canvas.height/2 + heartY(t) * scale/2
                });
                
                i += 0.05;
            } else if (!heartComplete) {
                heartComplete = true;
            }
            
            drawHeart();
            
            // Анимация текста после завершения сердца
            if (heartComplete) {
                animateText();
            }
            
            requestAnimationFrame(animate);
        }

        // Запуск анимации
        requestAnimationFrame(animate);
    </script>
</body>
</html>
